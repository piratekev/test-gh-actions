name: Manually triggered workflow
on:
  push:
    branches:
      - 'release-*'
    tags:
      - '*'


jobs:
  check:
      runs-on: ubuntu-latest
      outputs:
        branch: ${{ steps.check_step.outputs.branch }}
      steps:
        - name: Checkout
          uses: actions/checkout@v2
          with:
            fetch-depth: 0

        - name: Get current branch
          id: check_step
          run: |
            raw=$(git branch -r --contains ${{ github.ref }})
            branch=${raw##*/}
            echo "::set-output name=branch::$branch"
            echo "Branch is $branch."
            branch_version=$(echo $branch | cut -d- -f2)
            tag_version=$(echo ${{github.ref_name}} | cut -dv -f2)
            echo "::set-output name=branch_version::$branch_version"
            echo "::set-output name=tag_version::$tag_version"
            echo "branch_version is $branch_version."
            echo "tag_version is $tag_version."

  log-github-info:
    runs-on: ubuntu-latest
    needs: check
    steps:
      - run: echo ${{ needs.check.outputs.branch }} ${{ needs.check.outputs.branch_version }} ${{ needs.check.outputs.tag_version }}
